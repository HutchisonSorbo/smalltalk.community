# General Rules

- **Framework**: Next.js 14+ (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **Database**: Supabase / Drizzle ORM
- **State**: React Query / Zustand

# Sentry Configuration
- **Sentry DSN**: https://c9b0e3579848f4bbd146903260841961@o4508499244089344.ingest.us.sentry.io/4508502598975488
- **Organization**: hutchison-sorbo
- **Project**: javascript-nextjs

# File Persistence & Deployment Protocol
1. **The "Read-Back" Rule**: After ANY file write (tool or shell), you MUST read the file back (`cat filename`) to verify content stuck. Do not trust exit status 0.
2. **Git Integrity Check**: Before any git operation, run `git rev-parse --is-inside-work-tree`. If it fails, STOP and diagnose.
3. **Atomic & Verified**: 
   - Write File -> `cat` verify -> `git add` -> `git status` check -> `git commit` -> `git push`.
   - Never chain these. Verify each step.
4. **Lock Recovery**: If `git` locks, delete `.git/index.lock` ONLY. avoided aggressive `pkill` unless necessary to preserve environment stability.

# Security Rules
1. **No `dangerouslySetInnerHTML`**: Never use this unless absolutely necessary for third-party scripts. If used, strict code review is required.
2. **URL Sanitization**: ALL external links or user-provided URLs must be sanitized using `safeUrl(url)` from `@/lib/utils` before rendering in `href` or `src`.
3. **No `javascript:` URIs**: Explain why they are banned.
4. **Input Validation**: Use Zod schemas for all API routes and form inputs.
5. **No Direct DOM Manipulation**: Avoid `document.*` or `window.*` for rendering. Use React state.
